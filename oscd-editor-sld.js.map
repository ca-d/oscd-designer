{"version":3,"file":"oscd-editor-sld.js","sourceRoot":"","sources":["../oscd-editor-sld.ts"],"names":[],"mappings":"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","sourcesContent":["import { LitElement, html, css, nothing } from 'lit';\nimport { html as staticHtml, unsafeStatic } from 'lit/static-html.js';\n\nimport { property, query, state } from 'lit/decorators.js';\n\nimport {\n  AttributesV2,\n  EditV2,\n  SetAttributes,\n  Transactor,\n  Update,\n} from '@omicronenergy/oscd-api';\nimport { newEditEvent, newEditEventV2 } from '@omicronenergy/oscd-api/utils.js';\nimport { getReference } from '@openscd/oscd-scl';\n\nimport type { Dialog } from '@material/mwc-dialog';\nimport type { IconButtonToggle } from '@material/mwc-icon-button-toggle';\nimport '@material/mwc-button';\nimport '@material/mwc-fab';\nimport '@material/mwc-icon-button';\nimport '@material/mwc-icon-button-toggle';\nimport '@material/mwc-icon';\n\nimport './sld-editor.js';\n\nimport { bayIcon, equipmentIcon, ptrIcon, voltageLevelIcon } from './icons.js';\nimport {\n  attributes,\n  ConnectDetail,\n  ConnectEvent,\n  elementPath,\n  eqTypes,\n  isBusBar,\n  PlaceEvent,\n  PlaceLabelEvent,\n  Point,\n  privType,\n  removeNode,\n  removeTerminal,\n  reparentElement,\n  ResizeEvent,\n  ResizeTLEvent,\n  sldNs,\n  StartConnectDetail,\n  StartConnectEvent,\n  StartEvent,\n  StartPlaceEvent,\n  uuid,\n  xmlnsNs,\n} from './util.js';\n\nconst aboutContent = await fetch(new URL('about.html', import.meta.url)).then(\n  res => res.text(),\n);\n\nfunction makeBusBar(doc: XMLDocument, nsp: string) {\n  const busBar = doc.createElementNS(doc.documentElement.namespaceURI, 'Bay');\n  busBar.setAttribute('name', 'BB1');\n  busBar.setAttributeNS(sldNs, `${nsp}:w`, '2');\n  const cNode = doc.createElementNS(\n    doc.documentElement.namespaceURI,\n    'ConnectivityNode',\n  );\n  cNode.setAttribute('name', 'L');\n  const priv = doc.createElementNS(doc.documentElement.namespaceURI, 'Private');\n  priv.setAttribute('type', privType);\n  const section = doc.createElementNS(sldNs, `${nsp}:Section`);\n  section.setAttribute('bus', 'true');\n  const v1 = doc.createElementNS(sldNs, `${nsp}:Vertex`);\n  v1.setAttributeNS(sldNs, `${nsp}:x`, '0.5');\n  v1.setAttributeNS(sldNs, `${nsp}:y`, '0.5');\n  section.appendChild(v1);\n  const v2 = doc.createElementNS(sldNs, `${nsp}:Vertex`);\n  v2.setAttributeNS(sldNs, `${nsp}:x`, '1.5');\n  v2.setAttributeNS(sldNs, `${nsp}:y`, '0.5');\n  section.appendChild(v2);\n  priv.appendChild(section);\n  cNode.appendChild(priv);\n  busBar.appendChild(cNode);\n  return busBar;\n}\n\nfunction cutSectionAt(\n  section: Element,\n  index: number,\n  [x, y]: Point,\n  nsPrefix: string,\n): EditV2[] {\n  const parent = section.parentElement!;\n  const edits = [] as EditV2[];\n  const vertices = Array.from(section.getElementsByTagNameNS(sldNs, 'Vertex'));\n  const vertexAtXY = vertices.find(\n    ve =>\n      ve.getAttributeNS(sldNs, 'x') === x.toString() &&\n      ve.getAttributeNS(sldNs, 'y') === y.toString(),\n  );\n\n  if (\n    vertexAtXY === vertices[0] ||\n    vertexAtXY === vertices[vertices.length - 1]\n  ) {\n    return [];\n  }\n\n  const newSection = section.cloneNode(true) as Element;\n  Array.from(newSection.getElementsByTagNameNS(sldNs, 'Vertex'))\n    .slice(0, index + 1)\n    .forEach(vertex => vertex.remove());\n  const v = vertices[index].cloneNode() as Element;\n  v.setAttributeNS(sldNs, `${nsPrefix}:x`, x.toString());\n  v.setAttributeNS(sldNs, `${nsPrefix}:y`, y.toString());\n  v.removeAttributeNS(sldNs, 'uuid');\n  newSection.prepend(v);\n  edits.push({\n    node: newSection,\n    parent,\n    reference: section.nextElementSibling,\n  });\n\n  vertices.slice(index + 1).forEach(vertex => edits.push({ node: vertex }));\n\n  if (!vertexAtXY) {\n    const v2 = v.cloneNode();\n    edits.push({ node: v2, parent: section, reference: null });\n  }\n\n  return edits;\n}\n\nexport default class OscdEditorSLD extends LitElement {\n  @property({ type: Object })\n  editor!: Transactor<EditV2>;\n\n  @property({ type: Object })\n  doc!: XMLDocument;\n\n  @property({ type: Number })\n  get docVersion(): number {\n    return this._docVersion;\n  }\n\n  set docVersion(value: number) {\n    this.connecting = undefined;\n    if (!this.resizingBR?.parentElement) this.resizingBR = undefined;\n    if (!this.placingLabel?.parentElement) this.placingLabel = undefined;\n    this._docVersion = value;\n  }\n\n  @state()\n  private _docVersion = -1;\n\n  @state()\n  gridSize = 32;\n\n  @state()\n  nsp = 'esld';\n\n  @state()\n  templateElements: Record<string, Element> = {};\n\n  @state()\n  resizingBR?: Element;\n\n  @state()\n  resizingTL?: Element;\n\n  @state()\n  placing?: Element;\n\n  @state()\n  placingOffset: Point = [0, 0];\n\n  @state()\n  placingLabel?: Element;\n\n  @state()\n  connecting?: {\n    from: Element;\n    path: Point[];\n    fromTerminal: 'T1' | 'T2' | 'N1' | 'N2';\n  };\n\n  @state()\n  get showLabels(): boolean {\n    if (this.labelToggle) return this.labelToggle.on;\n    return true;\n  }\n\n  @query('#labels')\n  labelToggle?: IconButtonToggle;\n\n  @query('#about')\n  about?: Dialog;\n\n  zoomIn() {\n    this.gridSize += 3;\n  }\n\n  zoomOut() {\n    this.gridSize -= 3;\n    if (this.gridSize < 2) this.gridSize = 2;\n  }\n\n  startResizingBottomRight(element: Element | undefined) {\n    this.reset();\n    this.resizingBR = element;\n  }\n\n  startResizingTopLeft(element: Element | undefined) {\n    this.reset();\n    this.resizingTL = element;\n  }\n\n  startPlacing(element: Element | undefined, offset: Point = [0, 0]) {\n    this.reset();\n    this.placing = element;\n    this.placingOffset = offset;\n  }\n\n  startPlacingLabel(element: Element | undefined, offset: Point = [0, 0]) {\n    this.reset();\n    this.placingLabel = element;\n    this.placingOffset = offset;\n  }\n\n  startConnecting(detail: StartConnectDetail) {\n    this.reset();\n    this.connecting = detail;\n  }\n\n  reset() {\n    this.resizingBR = undefined;\n    this.resizingTL = undefined;\n    this.placing = undefined;\n    this.placingLabel = undefined;\n    this.connecting = undefined;\n  }\n\n  handleKeydown = ({ key }: KeyboardEvent) => {\n    if (key === 'Escape') this.reset();\n  };\n\n  connectedCallback() {\n    super.connectedCallback();\n    window.addEventListener('keydown', this.handleKeydown);\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    window.removeEventListener('keydown', this.handleKeydown);\n  }\n\n  updated(changedProperties: Map<string, unknown>) {\n    if (!changedProperties.has('doc')) return;\n    const sldNsPrefix = this.doc.documentElement.lookupPrefix(sldNs);\n    if (sldNsPrefix) {\n      this.nsp = sldNsPrefix;\n    } else {\n      this.doc.documentElement.setAttributeNS(xmlnsNs, 'xmlns:esld', sldNs);\n      this.nsp = 'esld';\n    }\n\n    [\n      'Substation',\n      'VoltageLevel',\n      'Bay',\n      'ConductingEquipment',\n      'PowerTransformer',\n      'TransformerWinding',\n    ].forEach(tag => {\n      this.templateElements[tag] = this.doc.createElementNS(\n        this.doc.documentElement.namespaceURI,\n        tag,\n      );\n    });\n    this.templateElements.BusBar = makeBusBar(this.doc, this.nsp);\n  }\n\n  rotateElement(element: Element) {\n    const { rot } = attributes(element);\n    const edits = [\n      {\n        element,\n        attributesNS: {\n          [sldNs]: {\n            [`${this.nsp}:rot`]: ((rot + 1) % 4).toString(),\n          },\n        },\n      },\n    ] as EditV2[];\n    if (\n      element.tagName === 'ConductingEquipment' ||\n      element.tagName === 'PowerTransformer'\n    ) {\n      Array.from(element.querySelectorAll('Terminal, NeutralPoint'))\n        .filter(terminal => terminal.getAttribute('cNodeName') !== 'grounded')\n        .forEach(terminal => edits.push(...removeTerminal(terminal)));\n    }\n    this.editor.commit(edits);\n  }\n\n  placeLabel(element: Element, x: number, y: number) {\n    const editV2: EditV2 = {\n      element,\n      attributesNS: {\n        [sldNs]: {\n          lx: x.toString(),\n          ly: y.toString(),\n        },\n      },\n    };\n    this.editor.commit(editV2);\n    this.reset();\n  }\n\n  placeElement(element: Element, parent: Element, x: number, y: number) {\n    const edits: EditV2[] = [];\n    if (element.parentElement !== parent) {\n      edits.push(...reparentElement(element, parent));\n    }\n\n    const {\n      pos: [oldX, oldY],\n      label: [oldLX, oldLY],\n      rot,\n    } = attributes(element);\n\n    const dx = x - oldX;\n    const dy = y - oldY;\n\n    if (element.localName !== 'Vertex') {\n      let lx = oldLX;\n      let ly = oldLY;\n      if (\n        element.tagName === 'ConductingEquipment' &&\n        !element.hasAttributeNS(sldNs, 'lx') &&\n        rot % 2 === 0\n      ) {\n        lx += 1;\n        ly += 1;\n      }\n      if (\n        element.tagName === 'PowerTransformer' &&\n        !element.hasAttributeNS(sldNs, 'lx')\n      ) {\n        if (rot < 2) lx += 1.5;\n        else {\n          lx -= 2;\n          ly += 2;\n        }\n      }\n      edits.push({\n        element,\n        attributesNS: {\n          [sldNs]: {\n            x: x.toString(),\n            y: y.toString(),\n            lx: (lx + dx).toString(),\n            ly: (ly + dy).toString(),\n          },\n        },\n      });\n    }\n\n    Array.from(element.querySelectorAll('Text')).forEach(text => {\n      const {\n        label: [textLX, textLY],\n      } = attributes(text);\n      const newAttributes = {\n        [sldNs]: {\n          lx: (textLX + dx).toString(),\n          ly: (textLY + dy).toString(),\n        },\n      };\n      edits.push({\n        element: text,\n        attributesNS: newAttributes,\n      });\n    });\n\n    Array.from(\n      element.querySelectorAll(\n        'Bay, ConductingEquipment, PowerTransformer, Vertex',\n      ),\n    ).forEach(descendant => {\n      const {\n        pos: [descX, descY],\n        label: [descLX, descLY],\n      } = attributes(descendant);\n      const newAttributes: AttributesV2 = {\n        x: (descX + dx).toString(),\n        y: (descY + dy).toString(),\n      };\n      if (descendant.localName !== 'Vertex') {\n        newAttributes.lx = (descLX + dx).toString();\n        newAttributes.ly = (descLY + dy).toString();\n      }\n      edits.push({\n        element: descendant,\n        attributesNS: {\n          [sldNs]: newAttributes,\n        },\n      });\n    });\n\n    if (\n      element.tagName === 'ConductingEquipment' ||\n      element.tagName === 'PowerTransformer'\n    ) {\n      Array.from(element.querySelectorAll('Terminal, NeutralPoint'))\n        .filter(terminal => terminal.getAttribute('cNodeName') !== 'grounded')\n        .forEach(terminal => edits.push(...removeTerminal(terminal)));\n\n      const groundedTerminals = Array.from(\n        element.querySelectorAll('Terminal, NeutralPoint'),\n      ).filter(terminal => terminal.getAttribute('cNodeName') === 'grounded');\n\n      if (groundedTerminals.length > 0) {\n        const bayName = parent.closest('Bay')?.getAttribute('name');\n        if (!bayName)\n          groundedTerminals.forEach(terminal =>\n            edits.push(...removeTerminal(terminal)),\n          );\n\n        let newCNode = parent.querySelector(\n          `ConnectivityNode[name=\"grounded\"]`,\n        );\n\n        if (!newCNode) {\n          newCNode = this.doc.createElementNS(\n            this.doc.documentElement.namespaceURI,\n            'ConnectivityNode',\n          );\n          newCNode.setAttribute('name', 'grounded');\n          newCNode.setAttribute('pathName', elementPath(parent, 'grounded'));\n\n          edits.push({\n            node: newCNode,\n            parent,\n            reference: getReference(parent, 'ConnectivityNode'),\n          });\n        }\n\n        const voltageLevelName = parent\n          .closest('VoltageLevel')\n          ?.getAttribute('name');\n        const substationName = parent\n          .closest('Substation')!\n          .getAttribute('name')!;\n        const connectivityNode = newCNode!.getAttribute('pathName');\n\n        groundedTerminals.forEach(terminal => {\n          edits.push({\n            element: terminal,\n            attributes: {\n              connectivityNode,\n              bayName,\n              voltageLevelName,\n              substationName,\n            },\n          });\n        });\n      }\n    } else if (element.getRootNode() === this.doc) {\n      Array.from(element.getElementsByTagName('ConnectivityNode')).forEach(\n        cNode => {\n          if (\n            Array.from(\n              this.doc.querySelectorAll(\n                `Terminal[connectivityNode=\"${cNode.getAttribute('pathName')}\"],\n                 NeutralPoint[connectivityNode=\"${cNode.getAttribute(\n                   'pathName',\n                 )}\"]`,\n              ),\n            ).find(terminal => terminal.closest(element.tagName) !== element)\n          )\n            edits.push(...removeNode(cNode));\n        },\n      );\n      Array.from(element.querySelectorAll('Terminal, NeutralPoint')).forEach(\n        terminal => {\n          const cNode = this.doc.querySelector(\n            `ConnectivityNode[pathName=\"${terminal.getAttribute(\n              'connectivityNode',\n            )}\"]`,\n          );\n          if (cNode && cNode.closest(element.tagName) !== element)\n            edits.push(...removeNode(cNode));\n        },\n      );\n    }\n\n    if (element.localName === 'Vertex') {\n      const bay = element.closest('Bay')!;\n      const sections = Array.from(bay.querySelectorAll('Section[bus]'));\n      const section = sections[0];\n      const vertex = section.querySelector('Vertex')!;\n      const lastSection = sections[sections.length - 1];\n      const lastVertex = lastSection.querySelector('Vertex:last-of-type')!;\n      const {\n        pos: [x1, y1],\n      } = attributes(vertex);\n      const w = x - x1 + 1;\n      const h = y - y1 + 1;\n      if (isBusBar(bay)) {\n        edits.push(...removeNode(section.closest('ConnectivityNode')!));\n        edits.push({\n          element: lastVertex,\n          attributesNS: {\n            [sldNs]: {\n              x: x.toString(),\n              y: y.toString(),\n            },\n          },\n        });\n        edits.push({\n          element: bay,\n          attributesNS: {\n            [sldNs]: {\n              w: w.toString(),\n              h: h.toString(),\n            },\n          },\n        });\n      }\n    }\n\n    this.editor.commit(edits);\n    if (\n      ['Bay', 'VoltageLevel'].includes(element.tagName) &&\n      (!element.hasAttributeNS(sldNs, 'w') ||\n        !element.hasAttributeNS(sldNs, 'h'))\n    )\n      this.startResizingBottomRight(element);\n    else this.reset();\n  }\n\n  connectEquipment({\n    from,\n    fromTerminal,\n    to,\n    toTerminal,\n    path,\n  }: ConnectDetail) {\n    if (\n      from.tagName === 'TransformerWinding' &&\n      to.tagName === 'TransformerWinding'\n    )\n      return;\n    const edits = [] as EditV2[];\n    let cNode: Element;\n    let connectivityNode: string;\n    let cNodeName: string;\n    let priv: Element;\n    if (to.tagName !== 'ConnectivityNode') {\n      cNode = this.doc.createElementNS(\n        this.doc.documentElement.namespaceURI,\n        'ConnectivityNode',\n      );\n      cNode.setAttribute('name', 'L1');\n      const bay = from.closest('Bay') || to.closest('Bay')!;\n      edits.push(...reparentElement(cNode, bay));\n      connectivityNode = (\n        edits.find(\n          e =>\n            e &&\n            'attributes' in e &&\n            e.attributes &&\n            'pathName' in e.attributes,\n        ) as SetAttributes | undefined\n      )?.attributes?.pathName as string;\n      cNodeName =\n        ((\n          edits.find(\n            e =>\n              e && 'attributes' in e && e.attributes && 'name' in e.attributes,\n          ) as Update | undefined\n        )?.attributes.name as string | undefined) ??\n        cNode.getAttribute('name')!;\n      priv = this.doc.createElementNS(\n        this.doc.documentElement.namespaceURI,\n        'Private',\n      );\n      priv.setAttribute('type', privType);\n      edits.push({\n        parent: cNode,\n        node: priv,\n        reference: getReference(cNode, 'Private'),\n      });\n    } else {\n      cNode = to;\n      connectivityNode = cNode.getAttribute('pathName')!;\n      cNodeName = cNode.getAttribute('name')!;\n      priv = cNode.querySelector(`Private[type=\"${privType}\"]`)!;\n    }\n    const section = this.doc.createElementNS(sldNs, `${this.nsp}:Section`);\n    edits.push({ parent: priv!, node: section, reference: null });\n    const fromTermUUID = uuid();\n    const toTermUUID = uuid();\n    path.forEach(([x, y], i) => {\n      const vertex = this.doc.createElementNS(sldNs, `${this.nsp}:Vertex`);\n      vertex.setAttributeNS(sldNs, `${this.nsp}:x`, x.toString());\n      vertex.setAttributeNS(sldNs, `${this.nsp}:y`, y.toString());\n      if (i === 0)\n        vertex.setAttributeNS(sldNs, `${this.nsp}:uuid`, fromTermUUID);\n      else if (i === path.length - 1 && to.tagName !== 'ConnectivityNode')\n        vertex.setAttributeNS(sldNs, `${this.nsp}:uuid`, toTermUUID);\n      edits.push({ parent: section, node: vertex, reference: null });\n    });\n    if (to.tagName === 'ConnectivityNode') {\n      const [x, y] = path[path.length - 1];\n      Array.from(priv.getElementsByTagNameNS(sldNs, 'Section')).find(s => {\n        const sectionPath = Array.from(\n          s.getElementsByTagNameNS(sldNs, 'Vertex'),\n        ).map(v => attributes(v).pos);\n        for (let i = 0; i < sectionPath.length - 1; i += 1) {\n          const [x0, y0] = sectionPath[i];\n          const [x1, y1] = sectionPath[i + 1];\n          if (\n            (y0 === y &&\n              y === y1 &&\n              ((x0 < x && x < x1) || (x1 < x && x < x0))) ||\n            (x0 === x &&\n              x === x1 &&\n              ((y0 < y && y < y1) || (y1 < y && y < y0))) ||\n            (y0 === y && x0 === x)\n          ) {\n            edits.push(cutSectionAt(s, i, [x, y], this.nsp));\n            return true;\n          }\n        }\n        return false;\n      });\n    }\n    const [substationName, voltageLevelName, bayName] = connectivityNode.split(\n      '/',\n      3,\n    );\n    const fromTagName = fromTerminal.startsWith('T')\n      ? 'Terminal'\n      : 'NeutralPoint';\n    const fromTermElement = this.doc.createElementNS(\n      this.doc.documentElement.namespaceURI,\n      fromTagName,\n    );\n    fromTermElement.setAttributeNS(sldNs, `${this.nsp}:uuid`, fromTermUUID);\n    fromTermElement.setAttribute('name', fromTerminal);\n    fromTermElement.setAttribute('connectivityNode', connectivityNode);\n    fromTermElement.setAttribute('substationName', substationName);\n    fromTermElement.setAttribute('voltageLevelName', voltageLevelName);\n    fromTermElement.setAttribute('bayName', bayName);\n    fromTermElement.setAttribute('cNodeName', cNodeName);\n    edits.push({\n      node: fromTermElement,\n      parent: from,\n      reference: getReference(from, fromTagName),\n    });\n    if (to.tagName === 'ConductingEquipment') {\n      const toTagName = toTerminal!.startsWith('T')\n        ? 'Terminal'\n        : 'NeutralPoint';\n      const toTermElement = this.doc.createElementNS(\n        this.doc.documentElement.namespaceURI,\n        toTagName,\n      );\n      toTermElement.setAttributeNS(sldNs, `${this.nsp}:uuid`, toTermUUID);\n      toTermElement.setAttribute('name', toTerminal!);\n      toTermElement.setAttribute('connectivityNode', connectivityNode);\n      toTermElement.setAttribute('substationName', substationName);\n      toTermElement.setAttribute('voltageLevelName', voltageLevelName);\n      toTermElement.setAttribute('bayName', bayName);\n      toTermElement.setAttribute('cNodeName', cNodeName);\n      edits.push({\n        node: toTermElement,\n        parent: to,\n        reference: getReference(to, toTagName),\n      });\n    }\n    this.reset();\n    this.editor.commit(edits);\n  }\n\n  render() {\n    if (!this.doc) return html`<p>Please open an SCL document</p>`;\n    return html`<main>\n      <nav>\n        ${\n          Array.from(\n            this.doc.querySelectorAll(\n              ':root > Substation > VoltageLevel > Bay',\n            ),\n          ).find(bay => !isBusBar(bay))\n            ? eqTypes\n                .map(\n                  eqType =>\n                    html`<mwc-fab\n                      mini\n                      label=\"Add ${eqType}\"\n                      title=\"Add ${eqType}\"\n                      @click=${() => {\n                        const element =\n                          this.templateElements.ConductingEquipment!.cloneNode() as Element;\n                        element.setAttribute('type', eqType);\n                        this.startPlacing(element);\n                      }}\n                      >${equipmentIcon(eqType)}</mwc-fab\n                    >`,\n                )\n                .concat()\n            : nothing\n        }${\n          this.doc.querySelector(':root > Substation > VoltageLevel')\n            ? html`<mwc-fab\n                  mini\n                  icon=\"horizontal_rule\"\n                  @click=${() => {\n                    const element = this.templateElements.BusBar!.cloneNode(\n                      true,\n                    ) as Element;\n                    this.startPlacing(element);\n                  }}\n                  label=\"Add Bus Bar\"\n                  title=\"Add Bus Bar\"\n                >\n                </mwc-fab\n                ><mwc-fab\n                  mini\n                  label=\"Add Bay\"\n                  title=\"Add Bay\"\n                  @click=${() => {\n                    const element =\n                      this.templateElements.Bay!.cloneNode() as Element;\n                    this.startPlacing(element);\n                  }}\n                  style=\"--mdc-theme-secondary: #12579B; --mdc-theme-on-secondary: white;\"\n                >\n                  ${bayIcon}\n                </mwc-fab>`\n            : nothing\n        }${\n          Array.from(this.doc.documentElement.children).find(\n            c => c.tagName === 'Substation',\n          )\n            ? html`<mwc-fab\n                mini\n                label=\"Add VoltageLevel\"\n                title=\"Add VoltageLevel\"\n                @click=${() => {\n                  const element =\n                    this.templateElements.VoltageLevel!.cloneNode() as Element;\n                  this.startPlacing(element);\n                }}\n                style=\"--mdc-theme-secondary: #F5E214;\"\n              >\n                ${voltageLevelIcon}\n              </mwc-fab>`\n            : nothing\n        }<mwc-fab\n          mini\n          icon=\"margin\"\n          @click=${() => this.insertSubstation()}\n          label=\"Add Substation\"\n          style=\"--mdc-theme-secondary: #BB1326; --mdc-theme-on-secondary: white;\"\n          title=\"Add Substation\"\n        >\n        </mwc-fab\n        >${\n          Array.from(this.doc.documentElement.children).find(\n            c => c.tagName === 'Substation',\n          )\n            ? html`<mwc-fab\n                  mini\n                  label=\"Add Single Winding Auto Transformer\"\n                  title=\"Add Single Winding Auto Transformer\"\n                  @click=${() => {\n                    const element =\n                      this.templateElements.PowerTransformer!.cloneNode() as Element;\n                    element.setAttribute('type', 'PTR');\n                    element.setAttributeNS(sldNs, `${this.nsp}:kind`, 'auto');\n                    element.setAttributeNS(sldNs, `${this.nsp}:rot`, '3');\n                    const winding =\n                      this.templateElements.TransformerWinding!.cloneNode() as Element;\n                    winding.setAttribute('type', 'PTW');\n                    winding.setAttribute('name', 'W1');\n                    element.appendChild(winding);\n                    this.startPlacing(element);\n                  }}\n                  >${ptrIcon(1, { kind: 'auto' })}</mwc-fab\n                ><mwc-fab\n                  mini\n                  label=\"Add Two Winding Auto Transformer\"\n                  title=\"Add Two Winding Auto Transformer\"\n                  @click=${() => {\n                    const element =\n                      this.templateElements.PowerTransformer!.cloneNode() as Element;\n                    element.setAttribute('type', 'PTR');\n                    element.setAttributeNS(sldNs, `${this.nsp}:kind`, 'auto');\n                    const windings = [];\n                    for (let i = 1; i <= 2; i += 1) {\n                      const winding =\n                        this.templateElements.TransformerWinding!.cloneNode() as Element;\n                      winding.setAttribute('type', 'PTW');\n                      winding.setAttribute('name', `W${i}`);\n                      windings.push(winding);\n                    }\n                    element.append(...windings);\n                    this.startPlacing(element);\n                  }}\n                  >${ptrIcon(2, { kind: 'auto' })}</mwc-fab\n                ><mwc-fab\n                  mini\n                  label=\"Add Two Winding Transformer\"\n                  title=\"Add Two Winding Transformer\"\n                  @click=${() => {\n                    const element =\n                      this.templateElements.PowerTransformer!.cloneNode() as Element;\n                    element.setAttribute('type', 'PTR');\n                    const windings = [];\n                    for (let i = 1; i <= 2; i += 1) {\n                      const winding =\n                        this.templateElements.TransformerWinding!.cloneNode() as Element;\n                      winding.setAttribute('type', 'PTW');\n                      winding.setAttribute('name', `W${i}`);\n                      windings.push(winding);\n                    }\n                    element.append(...windings);\n                    this.startPlacing(element);\n                  }}\n                  >${ptrIcon(2)}</mwc-fab\n                ><mwc-fab\n                  mini\n                  label=\"Add Three Winding Transformer\"\n                  title=\"Add Three Winding Transformer\"\n                  @click=${() => {\n                    const element =\n                      this.templateElements.PowerTransformer!.cloneNode() as Element;\n                    element.setAttribute('type', 'PTR');\n                    const windings = [];\n                    for (let i = 1; i <= 3; i += 1) {\n                      const winding =\n                        this.templateElements.TransformerWinding!.cloneNode() as Element;\n                      winding.setAttribute('type', 'PTW');\n                      winding.setAttribute('name', `W${i}`);\n                      windings.push(winding);\n                    }\n                    element.append(...windings);\n                    this.startPlacing(element);\n                  }}\n                  >${ptrIcon(3)}</mwc-fab\n                ><mwc-fab\n                  mini\n                  label=\"Add Single Winding Earthing Transformer\"\n                  title=\"Add Single Winding Earthing Transformer\"\n                  @click=${() => {\n                    const element =\n                      this.templateElements.PowerTransformer!.cloneNode() as Element;\n                    element.setAttribute('type', 'PTR');\n                    element.setAttributeNS(\n                      sldNs,\n                      `${this.nsp}:kind`,\n                      'earthing',\n                    );\n                    const winding =\n                      this.templateElements.TransformerWinding!.cloneNode() as Element;\n                    winding.setAttribute('type', 'PTW');\n                    winding.setAttribute('name', 'W1');\n                    element.appendChild(winding);\n                    this.startPlacing(element);\n                  }}\n                  >${ptrIcon(1, { kind: 'earthing' })}</mwc-fab\n                ><mwc-fab\n                  mini\n                  label=\"Add Two Winding Earthing Transformer\"\n                  title=\"Add Two Winding Earthing Transformer\"\n                  @click=${() => {\n                    const element =\n                      this.templateElements.PowerTransformer!.cloneNode() as Element;\n                    element.setAttribute('type', 'PTR');\n                    element.setAttributeNS(\n                      sldNs,\n                      `${this.nsp}:kind`,\n                      'earthing',\n                    );\n                    const windings = [];\n                    for (let i = 1; i <= 2; i += 1) {\n                      const winding =\n                        this.templateElements.TransformerWinding!.cloneNode() as Element;\n                      winding.setAttribute('type', 'PTW');\n                      winding.setAttribute('name', `W${i}`);\n                      windings.push(winding);\n                    }\n                    element.append(...windings);\n                    this.startPlacing(element);\n                  }}\n                  >${ptrIcon(2, { kind: 'earthing' })}</mwc-fab\n                >`\n            : nothing\n        }${\n          this.doc.querySelector('VoltageLevel, PowerTransformer')\n            ? html`<mwc-icon-button-toggle\n                id=\"labels\"\n                label=\"Toggle Labels\"\n                title=\"Toggle Labels\"\n                on\n                onIcon=\"font_download\"\n                offIcon=\"font_download_off\"\n                @click=${() => this.requestUpdate()}\n              ></mwc-icon-button-toggle>`\n            : nothing\n        }${\n          this.doc.querySelector('Substation')\n            ? html`<mwc-icon-button\n                  icon=\"zoom_in\"\n                  label=\"Zoom In\"\n                  title=\"Zoom In (${Math.round(\n                    (100 * (this.gridSize + 3)) / 32,\n                  )}%)\"\n                  @click=${() => this.zoomIn()}\n                >\n                </mwc-icon-button\n                ><mwc-icon-button\n                  icon=\"zoom_out\"\n                  label=\"Zoom Out\"\n                  ?disabled=${this.gridSize < 4}\n                  title=\"Zoom Out (${Math.round(\n                    (100 * (this.gridSize - 3)) / 32,\n                  )}%)\"\n                  @click=${() => this.zoomOut()}\n                ></mwc-icon-button>`\n            : nothing\n        }\n        </mwc-icon-button\n        >${\n          this.placing ||\n          this.resizingBR ||\n          this.resizingTL ||\n          this.connecting ||\n          this.placingLabel\n            ? html`<mwc-icon-button\n                icon=\"close\"\n                label=\"Cancel\"\n                title=\"Cancel\"\n                @click=${() => this.reset()}\n              ></mwc-icon-button>`\n            : html`<mwc-icon-button\n                icon=\"info\"\n                label=\"About\"\n                title=\"About\"\n                @click=${() => this.about?.show()}\n              ></mwc-icon-button>`\n        }\n      </nav>\n      ${Array.from(this.doc.querySelectorAll(':root > Substation')).map(\n        subs =>\n          html`<sld-editor\n            .editor=${this.editor}\n            .doc=${this.doc}\n            .editCount=${this.docVersion}\n            .substation=${subs}\n            .gridSize=${this.gridSize}\n            .resizingBR=${this.resizingBR}\n            .resizingTL=${this.resizingTL}\n            .placing=${this.placing}\n            .placingOffset=${this.placingOffset}\n            .placingLabel=${this.placingLabel}\n            .connecting=${this.connecting}\n            .showLabels=${this.showLabels}\n            @oscd-sld-start-resize-br=${({ detail }: StartEvent) => {\n              this.startResizingBottomRight(detail);\n            }}\n            @oscd-sld-start-resize-tl=${({ detail }: StartEvent) => {\n              this.startResizingTopLeft(detail);\n            }}\n            @oscd-sld-start-place=${({\n              detail: { element, offset },\n            }: StartPlaceEvent) => {\n              this.startPlacing(element, offset);\n            }}\n            @oscd-sld-start-place-label=${({\n              detail: { element, offset },\n            }: StartPlaceEvent) => {\n              this.startPlacingLabel(element, offset);\n            }}\n            @oscd-sld-start-connect=${({ detail }: StartConnectEvent) => {\n              this.startConnecting(detail);\n            }}\n            @oscd-sld-resize=${({ detail: { element, w, h } }: ResizeEvent) => {\n              this.dispatchEvent(\n                newEditEventV2({\n                  element,\n                  attributesNS: {\n                    [sldNs]: {\n                      w: w.toString(),\n                      h: h.toString(),\n                    },\n                  },\n                }),\n              );\n              this.reset();\n            }}\n            @oscd-sld-resize-tl=${({\n              detail: { element, x, y, w, h },\n            }: ResizeTLEvent) => {\n              const {\n                pos: [oldX, oldY],\n                label: [oldLX, oldLY],\n              } = attributes(element);\n              let lx = oldLX;\n              let ly = oldLY;\n              if (lx === oldX && ly === oldY) {\n                lx += x - oldX;\n                ly += y - oldY;\n              }\n              this.dispatchEvent(\n                newEditEventV2({\n                  element,\n                  attributesNS: {\n                    [sldNs]: {\n                      x: x.toString(),\n                      y: y.toString(),\n                      w: w.toString(),\n                      h: h.toString(),\n                      lx: lx.toString(),\n                      ly: ly.toString(),\n                    },\n                  },\n                }),\n              );\n              this.reset();\n            }}\n            @oscd-sld-place=${({\n              detail: { element, parent, x, y },\n            }: PlaceEvent) => this.placeElement(element, parent, x, y)}\n            @oscd-sld-place-label=${({\n              detail: { element, x, y },\n            }: PlaceLabelEvent) => this.placeLabel(element, x, y)}\n            @oscd-sld-connect=${({ detail }: ConnectEvent) =>\n              this.connectEquipment(detail)}\n            @oscd-sld-rotate=${({ detail }: StartEvent) =>\n              this.rotateElement(detail)}\n          ></sld-editor>`,\n      )}\n    </main>\n    ${staticHtml`<mwc-dialog id=\"about\" heading=\"About\">\n        <div>${unsafeStatic(aboutContent)}</div>\n        <mwc-button dialogAction=\"close\" slot=\"primaryAction\">\n          close\n        </mwc-button>\n      </mwc-dialog>`}`;\n  }\n\n  insertSubstation() {\n    const parent = this.doc.documentElement;\n    const node = this.doc.createElementNS(\n      this.doc.documentElement.namespaceURI,\n      'Substation',\n    );\n    const reference = getReference(parent, 'Substation');\n    let index = 1;\n    while (this.doc.querySelector(`:root > Substation[name=\"S${index}\"]`))\n      index += 1;\n    node.setAttribute('name', `S${index}`);\n    node.setAttributeNS(sldNs, `${this.nsp}:w`, '50');\n    node.setAttributeNS(sldNs, `${this.nsp}:h`, '25');\n    this.dispatchEvent(newEditEvent({ parent, node, reference }));\n    this.dispatchEvent(newEditEventV2({ parent, node, reference }));\n  }\n\n  static styles = css`\n    main {\n      padding: 16px;\n      width: fit-content;\n    }\n\n    div {\n      margin-top: 12px;\n    }\n\n    nav {\n      user-select: none;\n      position: sticky;\n      top: 68px;\n      left: 16px;\n      width: fit-content;\n      max-width: calc(100vw - 32px);\n      background: #fffd;\n      border-radius: 24px;\n      z-index: 1;\n    }\n\n    mwc-icon-button,\n    mwc-icon-button-toggle {\n      --mdc-theme-text-disabled-on-light: #aaa;\n      color: rgb(0, 0, 0 / 0.83);\n    }\n    mwc-fab {\n      --mdc-theme-secondary: #fff;\n      --mdc-theme-on-secondary: rgb(0, 0, 0 / 0.83);\n    }\n  `;\n}\n"]}